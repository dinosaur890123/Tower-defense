<!DOCTYPE html>
<html lang="en-AU">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tower Defense game</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div id="game-container">
        <div id="initial-start-screen">
            <h1 style="margin-top:0;">Tower Defense</h1>
            <p style="max-width:520px; margin:12px auto 24px; line-height:1.4;">
                Defend your base, earn gold, unlock knowledge upgrades and survive for as long as you can.
            </p>
            <button id="play-button" style="max-width:240px; margin:0 auto; display:block; font-size:1.1rem;">
                Play
            </button>
            <button id="how-to-button" style="max-width:240px;margin:14px auto 0;display:block;font-size:0.85rem;">
                How to play
            </button>
            <div id="how-to-panel" class="hidden" style="max-width:620px;margin:18px auto 0;font-size:0.85rem; background:#242442; padding:14px 16px; border:1px solid #4a4a7e; border-radius:8px;">
                Build towers on non-path tiles. Start waves to earn gold and knowledge. Upgrade towers specialise Basic at level 3.
                Meteor unlocks wave 3, Freeze wave 7. Endless auto-starts waves. Interest paid after each wave, so only use whats needed
            </div>
        </div>
        <h1 class="hidden" id="main-title">Tower Defense</h1>
        <div id="map-selection-screen">
            <h2>Select a map</h2>
            <div id="knowledge-panel" style="margin:15px auto 25px; max-width:560px; background:#242442; border:1px solid #4a4a7e; padding:12px; border-radius:8px;">
                <h2 style="margin:4px 0 10px;">Knowledge (Meta Progression)</h2>
                <div id="knowledge-points-display" style="margin-bottom:8px; font-weight: bold;">Knowledge: 0</div>
                <div id="knowledge-upgrades" style="display:flex; flex-wrap:wrap; gap:8px; justify-content:center;"></div>
                <button data-up="startGold1">+20 Starting Gold (Cost: 5)</button>
                <button data-up="startHealth1">+20 Base Health (Cost: 5)</button>
                <button data-up="interest1">+2% Interest & +10 Cap (Cost: 8)</button>
                <button data-up="towerRange1">All Towers +5% Range</button>
                <button data-up="camoEarly">Basic Tower Camo at L1 (Cost: 12)</button>
            </div>
            <div id="map-selection-buttons">
                <button id="map-easy-button" class="map-button">
                    <strong>Green Valley (Easy)</strong>
                    <small>A short, easy path. Starts with 120 Health & 120 gold.</small>
                </button>
                <button id="map-medium-button" class="map-button">
                    <strong>S curve map (Medium)</strong>
                    <small>The classic map. Starts with 100 Health & 100 gold.</small>
                </button>
                <button id="map-hard-button" class="map-button">
                    <strong>Twisted Path (Hard)</strong>
                    <small>A long, winding path. Starts with 80 Health & 80 gold.</small>
                </button>
            </div>
        </div>
        <div id="stats-bar" class="hidden">
            <div class="stat-card">
                <div>Base Health</div>
                <div id="base-health-display">0</div>
            </div>
            <div class="stat-card">
                <div>Gold</div>
                <div id="gold-display"></div>
            </div>
            <div class="stat-card">
                <div>Wave</div>
                <div id="wave-display"></div>
            </div>
        </div>
        <div id="main-content" class="hidden">
            <canvas id="gameCanvas" width="800" height="600"></canvas>
            <div id="ui-panel">
                <h2>Controls</h2>
                <button id="build-turret-button">
                    Build Turret (50 Gold)
                </button>
                <button id="build-frost-button">
                    Build Frost Tower (75 Gold)
                </button>
                <button id="build-bomb-button"> <!-- no no this is not what it sounds like, this sounds so wrong...-->
                    Build Bomb Tower (120 Gold)
                </button>
                <button id="start-wave-button">
                    Start wave
                </button>
                <button id="pause-button">Pause</button>
                <button id="speed-button">Speed: 1x</button>
                <label id="endless-option" style="display: block; margin-top:8px; font-size:0.9rem;">
                    <input type="checkbox" id="endless-toggle"> Endless Mode (auto waves)
                </label>
                <button id="build-mine-button">
                    Build Gold mine (200 Gold)
                </button>
                <div id="message-box"></div>
            </div>
            <div id="upgrade-menu-container" class="hidden">
                <h3 id="tower-stats-title">Tower Stats</h3>
                <div id="tower-stats-display"></div>
                <div id="targeting-section">
                    <h4>Targeting</h4>
                    <button id="target-first-button" class="target-button">First</button>
                    <button id="target-last-button" class="target-button">Last</button>
                    <button id="target-closest-button" class="target-button">Closest</button>
                    <button id="target-strongest-button" class="target-button">Strongest</button>
                    <button id="target-weakest-button" class="target-button">Weakest</button>
                    <button id="target-fastest-button" class="target-button">Fastest</button>
                </div>
                <div id="path-options" class="hidden" style="margin:8px">
                    <h4>Specialise</h4>
                    <div id="path-previews" style="display:flex; gap:8px; flex-wrap:wrap;"></div>
                </div>
                <div id="upgrade-options">
                    <button id="upgrade-tower-button">Upgrade (100 Gold)</button>
                </div>
                <button id="sell-tower-button" class="sell-button">Sell (75 Gold)</button>
                <button id="deselect-tower-button">Close</button>
            </div>
            <div id="spell-container">
                <button id="meteor-strike-button" class="spell-button hidden">
                    <div class="spell-text">Meteor (120s)</div>
                    <div class="cooldown-overlay"></div>
                    <div class="cooldown-text"></div>
                </button>
                <button id="global-freeze-button" class="spell-button hidden">
                    <div class="spell-text">Freeze (180s)</div>
                    <div class="cooldown-overlay"></div>
                    <div class="cooldown-text"></div>
                </button>
            </div>
        </div>
    </div>
    <script src="script.js" defer></script>
</body>
</html>